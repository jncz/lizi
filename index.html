<html>
	<head>
		<meta http-equiv=Content-Type content="text/html;charset=utf-8">
		<title>Game 1</title>
		<script type="text/javascript" src="engine/js/util.js"></script>
		<script type="text/javascript" src="engine/js/globalScope.js"></script>
		<script type="text/javascript" src="engine/js/amd/requirejs/require.js"></script>
		<script>
			"use strict"
			var actor;
			require.config({ 
				baseUrl: "./", 
				paths: { 
					"engine": "engine/js"
				}, 
				urlArgs: "bust=",
				waitSeconds: 2 
			 }); 
			 require( ["./booter.js","engine/MovementObject","engine/MovieClip","engine/Constants","engine/Direction"], 
				function(starter,MovementObject,MovieClip2D,C,direction) {
					var imgs = ["Actor1.png","map.png","donghua.png","eff.png"];
					var json = ["map.json","map4.json"];
					starter.regImgRes(imgs);
					starter.regJSONRes(json);
					starter.regCustomerBoot(function(){
						//It will be called at the end of the engine boot
						console.log("cust boot");
						var fashi = g.LOADED_XMLS[0];
						var mc = new MovieClip2D(g.LOADED_IMGS[2],fashi.quadFrameList);
						mc.isPlay=2;
						mc.x=300;
						mc.y=300;
						stage2d.addChild(mc,1);
						
						///////////////////////////
						
						function addMainActorClip(){
							var mc = createMovementObj();//new MovementObject(imageLoaded[0]);
							mc.isPlay = 1;
							mc.x = 400;
							mc.y = 300;
							
							mc.totalFrames = 3;
							mc.ifReverse = false;
							
							mc.moveDirection = [C.DIRECTION_LEFT,C.DIRECTION_RIGHT];
							
							mc.frameHeadX = 3;
							mc.frameHeadY = 0;
							mc.faceLeft = [3,1];
							mc.faceRight = [3,2];
							mc.faceUp = [3,3];
							mc.faceDown = [3,0];
							
							stage2d.addChild(mc,0);
							
							mc.addEventListener("keyDown",function(e){
								var step = 2;
								mc.movement(direction.getDirection(e),step);
							});
							
							regAsMainActor(mc);
						}

						function createMovementObj(){
							var obj = new MovementObject(g.LOADED_IMGS[0]);
							extend(obj,new MovieClip2D());
							return obj;
						}

						function regAsMainActor(obj){
							actor = obj;
						}
						
						addMainActorClip();
					});
					starter.boot();
				} 
			  ); 
		</script>
	</head>
	<style>
		html,body{
			margin:0px;
			padding:0px;
		}
	</style>
	<body>
		<canvas id="mycanvas" width="1024" height="768"></canvas>
	</body>
</html>